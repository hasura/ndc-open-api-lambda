packagingDefinition:
  type: ManagedDockerBuild
supportedEnvironmentVariables:
  - name: NDC_OAS_DOCUMENT_URI
    description: "The URI of OAS Document. If not provided, the connector will look for `/etc/connector/swagger.json` by default"
  - name: NDC_OAS_BASE_URL
    description: "Base url of the API"
  - name: NDC_OAS_LAMBDA_PRETTY_LOGS
    description: "Print logs in a human readable format instead of JSON"
    default: "true"
  - name: NDC_OAS_FILE_OVERWRITE
    description: "Overwrite previously generated functions.ts file and api.ts file"
    default: "false"
  - name: NDC_LAMBDA_SDK_VERSION
    description: "Version of the NDC Lambda SDK to be used"
commands:
  update: "docker run --rm -e HASURA_PLUGIN_CONNECTOR_CONTEXT_PATH -e NDC_OAS_BASE_URL -e NDC_OAS_DOCUMENT_URI -e NDC_OAS_LAMBDA_PRETTY_LOGS -e NDC_OAS_FILE_OVERWRITE -e NDC_LAMBDA_SDK_VERSION -v ${HASURA_PLUGIN_CONNECTOR_CONTEXT_PATH}:/etc/connector ghcr.io/hasura/ndc-open-api-lambda:v0.0.2-alpha update"
dockerComposeWatch:
  # Rebuild the container if a new package restore is required because package[-lock].json changed
  - path: package.json
    target: /functions/package.json
    action: rebuild
  - path: package-lock.json
    target: /functions/package-lock.json
    action: rebuild
  # For any other file change, simply copy it into the existing container and restart it
  - path: ./
    target: /functions
    action: sync+restart
    exclude: swagger.json
